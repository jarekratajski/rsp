{
"version":3,
"file":"korolev-client.min.js.map",
"lineCount":20,
"mappings":"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",
"sources":["C:/Users/ThinkPad/project/korolev/korolev/src/main/es6/utils.js"," [synthetic:util/global] ","C:/Users/ThinkPad/project/korolev/korolev/src/main/es6/korolev.js","C:/Users/ThinkPad/project/korolev/korolev/src/main/es6/bridge.js","C:/Users/ThinkPad/project/korolev/korolev/src/main/es6/connection.js","C:/Users/ThinkPad/project/korolev/korolev/src/main/es6/launcher.js"],
"sourcesContent":["export function getDeviceId() {\r\n  return getCookie('deviceId');\r\n}\r\n\r\n/** @param {string} name */\r\nfunction getCookie(name) {\r\n  var matches = document.cookie.match(new RegExp(\r\n    \"(?:^|; )\" + name.replace(/([.$?*|{}()\\[\\]\\\\\\/+^])/g, '\\\\$1') + \"=([^;]*)\"\r\n  ));\r\n  return matches ? decodeURIComponent(matches[1]) : undefined;\r\n}\r\n\r\nexport class ConnectionLostWidget {\r\n\r\n  /** @param {string} template */\r\n  constructor(template) {\r\n    /** @type {?Element} */\r\n    this._element = null;\r\n    this._template = template;\r\n  }\r\n\r\n  show() {\r\n\r\n    if (this._element !== null)\r\n      return;\r\n\r\n    // Parse template\r\n    var element = document.createElement('div');\r\n    element.innerHTML = this._template;\r\n    element = element.children[0];\r\n\r\n    // Append to document body\r\n    document.body.appendChild(element);\r\n    this._element = element;\r\n  }\r\n\r\n  hide() {\r\n    if (this._element !== null) {\r\n      document.body.removeChild(this._element);\r\n      this._element = null;\r\n    }\r\n  }\r\n}\r\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Runtime code to store the global object.\n */\n'require base';\n'declare global';\n'declare window';\n\n\n/**\n * @param {!Object} maybeGlobal\n * @return {!Object} The global object.\n * @suppress {undefinedVars|reportUnknownTypes}\n */\n$jscomp.getGlobal = function(maybeGlobal) {\n  // This logic can be simplified to be made more optimizable.\n  return (typeof window != 'undefined' && window === maybeGlobal) ?\n      maybeGlobal :\n      (typeof global != 'undefined' && global != null) ?\n      /** @type {!Object} */ (global) :\n      maybeGlobal;\n};\n\n\n// TODO(sdh): This should be typed as \"the global object\" now that the type\n// of \"Global\" has landed in the type system.\n/**\n * The global object. For browsers we could just use `this` but in Node that\n * doesn't work.\n * @const {?}\n */\n$jscomp.global = $jscomp.getGlobal(this);\n","import { getDeviceId } from './utils.js';\r\n\r\n/** @enum {number} */\r\nexport const CallbackType = {\r\n  DOM_EVENT: 0, // `$renderNum:$elementId:$eventType`\r\n  CUSTOM_CALLBACK: 1, // `$name:$arg`\r\n  EXTRACT_PROPERTY_RESPONSE: 2, // `$descriptor:$propertyType:$value`\r\n  HISTORY: 3, // URL\r\n  EVALJS_RESPONSE: 4, // `$descriptor:$status:$value`\r\n  EXTRACT_EVENT_DATA_RESPONSE: 5, // `$descriptor:$dataJson`\r\n  HEARTBEAT: 6 // `$descriptor`\r\n};\r\n\r\n/** @enum {number} */\r\nexport const PropertyType = {\r\n  STRING: 0,\r\n  NUMBER: 1,\r\n  BOOLEAN: 2,\r\n  OBJECT: 3,\r\n  ERROR: 4\r\n};\r\n\r\nexport class Korolev {\r\n\r\n  /**\r\n   * @param {Object} config\r\n   * @param {function(CallbackType, string)} callback\r\n   */\r\n  constructor(config, callback) {\r\n    /** @type {Object} */\r\n    this.config = config;\r\n    /** @type {HTMLElement} */\r\n    this.root = document.children[0];\r\n    /** @type {Object<Element>} */\r\n    this.els = {};\r\n    /** @type {number} */\r\n    this.renderNum = 0;\r\n    /** @type {Array} */\r\n    this.rootListeners = [];\r\n    /** @type {?function(Event)} */\r\n    this.historyHandler = null;\r\n    /** @type {string} */\r\n    this.initialPath = window.location.pathname;\r\n    /** @type {function(CallbackType, string)} */\r\n    this.callback = callback;\r\n    /** @type {Array} */\r\n    this.eventData = [];\r\n\r\n    this.listenRoot = (name, preventDefault) => {\r\n      var listener = (event) => {\r\n        if (event.target.vId) {\r\n          if (preventDefault) {\r\n            event.preventDefault();\r\n          }\r\n          this.eventData[this.renderNum] = event;\r\n          this.callback(CallbackType.DOM_EVENT, this.renderNum + ':' + event.target.vId + ':' + event.type);\r\n        }\r\n      };\r\n      this.root.addEventListener(name, listener);\r\n      this.rootListeners.push({ 'listener': listener, 'type': name });\r\n    };\r\n\r\n    this.listenRoot('submit', true);\r\n\r\n    this.historyHandler = (/** @type {Event} */ event) => {\r\n      if (event.state === null) callback(CallbackType.HISTORY, this.initialPath);\r\n      else callback(CallbackType.HISTORY, event.state);\r\n    };\r\n\r\n    this.windowHandler = (/** @type {Event} */ event) => {\r\n      // 1 - event for top level element only ('body)\r\n      this.eventData[this.renderNum] = event.target;\r\n      callback(CallbackType.DOM_EVENT, this.renderNum + ':' + 1 + ':' + event.type);\r\n    };\r\n\r\n    window.addEventListener('popstate', this.historyHandler);\r\n    window.addEventListener('resize', this.windowHandler);\r\n  }\r\n\r\n  swapElementInRegistry(a, b) {\r\n    b.vId = a.vId;\r\n    this.els[a.vId] = b;\r\n  }\r\n\r\n  destroy() {\r\n    // Remove root listeners\r\n    this.rootListeners.forEach((o) => this.root.removeEventListener(o.type, o.listener));\r\n    // Remove popstate handler\r\n    window.removeEventListener('popstate', this.historyHandler);\r\n    window.removeEventListener('resize', this.windowHandler);\r\n  }\r\n  \r\n  /** @param {number} n */\r\n  setRenderNum(n) {\r\n    // Remove obsolete event data\r\n    delete this.eventData[n - 2];\r\n    this.renderNum = n;\r\n  }\r\n\r\n  /** @param {HTMLElement} rootNode */\r\n  registerRoot(rootNode) {\r\n    let self = this;\r\n    function aux(prefix, node) {\r\n      var children = node.childNodes;\r\n      for (var i = 0; i < children.length; i++) {\r\n        var child = children[i];\r\n        var qsid = prefix + '_' + (i + 1);\r\n        child.vId = qsid;\r\n        self.els[qsid] = child;\r\n        aux(qsid, child);\r\n      }\r\n    }\r\n    self.root = rootNode;\r\n    self.els[\"1\"] = rootNode;\r\n    aux(\"1\", rootNode);\r\n  }\r\n\r\n  cleanRoot() {\r\n    while (this.root.children.length > 0)\r\n      this.root.removeChild(this.root.children[0]);\r\n  }\r\n\r\n   /**\r\n    * @param {string} type\r\n    * @param {boolean} preventDefault\r\n    */\r\n  listenEvent(type, preventDefault) {\r\n    this.listenRoot(type, preventDefault);\r\n  }\r\n\r\n  /**\r\n   * @param {Array} data\r\n   */\r\n  modifyDom(data) {\r\n    // Reverse data to use pop() instead of shift()\r\n    // pop() faster than shift()\r\n    let atad = data.reverse();\r\n    let r = atad.pop.bind(atad);\r\n    while (data.length > 0) {\r\n      switch (r()) {\r\n        case 0: this.create(r(), r(), r(), r()); break;\r\n        case 1: this.createText(r(), r(), r()); break;\r\n        case 2: this.remove(r(), r()); break;\r\n        case 3: this.setAttr(r(), r(), r(), r(), r()); break;\r\n        case 4: this.removeAttr(r(), r(), r(), r()); break;\r\n        case 5: this.setStyle(r(), r(), r()); break;\r\n        case 6: this.removeStyle(r(), r()); break;\r\n      }\r\n    }\r\n  }\r\n  \r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} childId\r\n    * @param {string} tag\r\n    */\r\n  create(qsid, childId, xmlNs, tag) {\r\n    var parent = this.els[qsid],\r\n      child = this.els[childId],\r\n      newElement;\r\n    if (!parent) return;\r\n    if (xmlNs === 0) {\r\n      newElement = document.createElement(tag);\r\n    } else {\r\n      newElement = document.createElementNS(xmlNs, tag);\r\n    }\r\n    newElement.vId = childId;\r\n    if (child && child.parentNode === parent) {\r\n      parent.replaceChild(newElement, child);\r\n    } else {\r\n      parent.appendChild(newElement);\r\n    }\r\n    this.els[childId] = newElement;\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} childId\r\n    * @param {string} text\r\n    */\r\n  createText(qsid, childId, text) {\r\n    var parent = this.els[qsid],\r\n      child = this.els[childId],\r\n      newElement;\r\n    if (!parent) return;\r\n    newElement = document.createTextNode(text);\r\n    newElement.vId = childId;\r\n    if (child && child.parentNode === parent) {\r\n      parent.replaceChild(newElement, child);\r\n    } else {\r\n      parent.appendChild(newElement);\r\n    }\r\n    this.els[childId] = newElement;\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} childId\r\n    */\r\n  remove(qsid, childId) {\r\n    var parent = this.els[qsid],\r\n      child = this.els[childId];\r\n    if (!parent) return;\r\n    if (child) {\r\n      parent.removeChild(child);\r\n    }\r\n  }\r\n\r\n   /**\r\n    * @param {string} descriptor\r\n    * @param {string} qsid\r\n    * @param {string} propertyName\r\n    */\r\n  extractProperty(descriptor, qsid, propertyName) {\r\n    let element = this.els[qsid];\r\n    let value = element[propertyName];\r\n    var result, type;\r\n    switch (typeof value) {\r\n      case 'undefined':\r\n        type = PropertyType.ERROR;\r\n        result = `${propertyName} is undefined`;\r\n        break;\r\n      case 'function':\r\n        type = PropertyType.ERROR;\r\n        result = `${propertyName} is a function`;\r\n        break;\r\n      case 'object':\r\n        type = PropertyType.OBJECT;\r\n        result = JSON.stringify(value);\r\n        break;\r\n      case 'string':\r\n        type = PropertyType.STRING;\r\n        result = value;\r\n        break;\r\n      case 'number':\r\n        type = PropertyType.NUMBER;\r\n        result = value;\r\n        break;\r\n      case 'boolean':\r\n        type = PropertyType.BOOLEAN;\r\n        result = value;\r\n        break;\r\n    }\r\n    this.callback(\r\n      CallbackType.EXTRACT_PROPERTY_RESPONSE,\r\n      `${descriptor}:${type}:${result}`\r\n    );\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} name\r\n    * @param {string} value\r\n    * @param {boolean} isProperty\r\n    */\r\n  setAttr(qsid, xmlNs, name, value, isProperty) {\r\n    var element = this.els[qsid];\r\n    if (isProperty) element[name] = value;\r\n    else if (xmlNs === 0) {\r\n      element.setAttribute(name, value);\r\n    } else {\r\n      element.setAttributeNS(xmlNs, name, value);\r\n    }\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} name\r\n    * @param {boolean} isProperty\r\n    */\r\n  removeAttr(qsid, xmlNs, name, isProperty) {\r\n    var element = this.els[qsid];\r\n    if (isProperty) element[name] = undefined;\r\n    else if (xmlNs === 0) {\r\n      element.removeAttribute(name);\r\n    } else {\r\n      element.removeAttributeNS(xmlNs, name);\r\n    }\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} name\r\n    * @param {string} value\r\n    */\r\n  setStyle(qsid, name, value) {\r\n    var element = this.els[qsid];\r\n    element.style[name] = value;\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} name\r\n    */\r\n  removeStyle(qsid, name) {\r\n    var element = this.els[qsid];\r\n    element.style[name] = null;\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    */\r\n  focus(qsid) {\r\n    setTimeout(() => {\r\n      var element = this.els[qsid];\r\n      element.focus();\r\n    }, 0);\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    */\r\n  element(qsid) {\r\n    return this.els[qsid];\r\n  }\r\n\r\n   /**\r\n    * @param {string} path\r\n    */\r\n  changePageUrl(path) {\r\n    if (path !== window.location.pathname)\r\n      window.history.pushState(path, '', path);\r\n  }\r\n\r\n   /**\r\n    * @param {string} name\r\n    * @param {string} arg\r\n    */\r\n  invokeCustomCallback(name, arg) {\r\n    this.callback(CallbackType.CUSTOM_CALLBACK, [name, arg].join(':'));\r\n  }\r\n\r\n   /**\r\n    * @param {string} qsid\r\n    * @param {string} descriptor\r\n    */\r\n  uploadForm(qsid, descriptor) {\r\n    let self = this;\r\n    var form = self.els[qsid];\r\n    var formData = new FormData(form);\r\n    var request = new XMLHttpRequest();\r\n    var deviceId = getDeviceId();\r\n    var uri = self.config['r'] +\r\n      'bridge' +\r\n      '/' + deviceId +\r\n      '/' + self.config['sid'] +\r\n      '/form-data' +\r\n      '/' + descriptor;\r\n    request.open(\"POST\", uri, true);\r\n//    request.upload.onprogress = function(event) {\r\n//      var arg = [descriptor, event.loaded, event.total].join(':');\r\n//      self.callback(CallbackType.FORM_DATA_PROGRESS, arg);\r\n//    };\r\n    request.send(formData);\r\n  }\r\n\r\n  /**\r\n    * @param {string} qsid\r\n    * @param {string} descriptor\r\n    */\r\n  listFiles(qsid, descriptor) {\r\n    let self = this;\r\n    let input = self.els[qsid];\r\n    let deviceId = getDeviceId();\r\n    let files = [];\r\n    let uri = self.config['r'] +\r\n      'bridge' +\r\n      '/' + deviceId +\r\n      '/' + self.config['sid'] +\r\n      '/file' +\r\n      '/' + descriptor;\r\n    for (var i = 0; i < input.files.length; i++) {\r\n      files.push(input.files[i]);\r\n    }\r\n    // Send first request with information about files\r\n    let request = new XMLHttpRequest();\r\n    request.open('POST', uri + \"/info\", true);\r\n    request.send(files.map((f) => `${f.name}/${f.size}`).join('\\n'));\r\n  }\r\n\r\n  /**\r\n   * @param {string} qsid\r\n   * @param {string} descriptor\r\n   * @param {string} fileName\r\n   */\r\n  uploadFile(qsid, descriptor, fileName) {\r\n    let self = this;\r\n    let input = self.els[qsid];\r\n    let deviceId = getDeviceId();\r\n    let uri = self.config['r'] +\r\n        'bridge' +\r\n        '/' + deviceId +\r\n        '/' + self.config['sid'] +\r\n        '/file' +\r\n        '/' + descriptor;\r\n    var file = null;\r\n\r\n    for (var i = 0; i < input.files.length; i++) {\r\n      if(input.files[i].name == fileName) {\r\n        file = input.files[i];\r\n      }\r\n    }\r\n\r\n    if(file) {\r\n      let request = new XMLHttpRequest();\r\n      request.open('POST', uri, true);\r\n      request.setRequestHeader('x-name', file.name)\r\n      request.send(file);\r\n    } else {\r\n      console.error(`Can't find file with name ${fileName}`);\r\n    }\r\n  }\r\n\r\n  resetForm(qsid) {\r\n    let element = this.els[qsid];\r\n    element.reset();\r\n  }\r\n\r\n  reloadCss() {\r\n    var links = document.getElementsByTagName(\"link\");\r\n    for (var i = 0; i < links.length; i++) {\r\n      var link = links[i];\r\n      if (link.getAttribute(\"rel\") === \"stylesheet\")\r\n        link.href = link.href + \"?refresh=\" + new Date().getMilliseconds();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {string} descriptor\r\n   * @param {string} code\r\n   */\r\n  evalJs(descriptor, code) {\r\n    var result;\r\n    var status = 0;\r\n    try {\r\n      result = eval(code);\r\n    } catch (e) {\r\n      console.error(`Error evaluating code ${code}`, e);\r\n      result = e;\r\n      status = 1;\r\n    }\r\n\r\n    if (result instanceof Promise) {\r\n      result.then(\r\n        (res) => this.callback(CallbackType.EVALJS_RESPONSE,`${descriptor}:0:${JSON.stringify(res)}`),\r\n        (err) => {\r\n          console.error(`Error evaluating code ${code}`, err);\r\n          this.callback(CallbackType.EVALJS_RESPONSE,`${descriptor}:1:err}`)\r\n        }\r\n      );\r\n    } else {\r\n      var resultString;\r\n      if (status === 1) resultString = result.toString();\r\n      else resultString = JSON.stringify(result);\r\n      this.callback(\r\n        CallbackType.EVALJS_RESPONSE,\r\n        `${descriptor}:${status}:${resultString}`\r\n      );\r\n    }\r\n  }\r\n\r\n  extractEventData(descriptor, renderNum) {\r\n    let data = this.eventData[renderNum];\r\n    let result = {};\r\n    for (let propertyName in data) {\r\n      let value = data[propertyName];\r\n      switch (typeof value) {\r\n        case 'string':\r\n        case 'number':\r\n        case 'boolean':\r\n          result[propertyName] = value;\r\n          break;\r\n        case 'object':\r\n          if (propertyName === 'detail') {\r\n            result[propertyName] = value;\r\n          }\r\n          break;\r\n        default: // do nothing\r\n      }\r\n    }\r\n    this.callback(\r\n      CallbackType.EXTRACT_EVENT_DATA_RESPONSE,\r\n      `${descriptor}:${JSON.stringify(result)}`\r\n    );\r\n  }\r\n}\r\n","import { Korolev, CallbackType } from './korolev.js';\r\nimport { Connection } from './connection.js';\r\n\r\nconst ProtocolDebugEnabledKey = \"$bridge.protocolDebugEnabled\";\r\n\r\nvar protocolDebugEnabled = window.localStorage.getItem(ProtocolDebugEnabledKey) === 'true';\r\n\r\nexport class Bridge {\r\n\r\n  /**\r\n   * @param {Connection} connection\r\n   */\r\n  constructor(config, connection) {\r\n    this._korolev = new Korolev(config, this._onCallback.bind(this));\r\n    this._korolev.registerRoot(document.children[0]);\r\n    this._connection = connection;\r\n    this._messageHandler = this._onMessage.bind(this);\r\n\r\n    connection.dispatcher.addEventListener(\"message\", this._messageHandler);\r\n\r\n    let interval = parseInt(config['heartbeatInterval'], 10);\r\n\r\n    if (interval > 0) {\r\n      this._intervalId = setInterval(() => this._onCallback(CallbackType.HEARTBEAT), interval);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {CallbackType} type\r\n   * @param {string} [args]\r\n   */\r\n  _onCallback(type, args) {\r\n    let message = JSON.stringify(args !== undefined ? [type, args] : [type]);\r\n    if (protocolDebugEnabled)\r\n      console.log('<-', message);\r\n    this._connection.send(message);\r\n  }\r\n\r\n  _onMessage(event) {\r\n    if (protocolDebugEnabled)\r\n      console.log('->', event.data);\r\n    let commands = /** @type {Array} */ (JSON.parse(event.data));\r\n    let pCode = commands.shift();\r\n    let k = this._korolev;\r\n    switch (pCode) {\r\n      case 0: k.setRenderNum.apply(k, commands); break;\r\n      case 1: k.cleanRoot.apply(k, commands); break;\r\n      case 2: k.listenEvent.apply(k, commands); break;\r\n      case 3: k.extractProperty.apply(k, commands); break;\r\n      case 4: k.modifyDom(commands); break;\r\n      case 5: k.focus.apply(k, commands); break;\r\n      case 6: k.changePageUrl.apply(k, commands); break;\r\n      case 7: k.uploadForm.apply(k, commands); break;\r\n      case 8: k.reloadCss.apply(k, commands); break;\r\n      case 9: break;\r\n      case 10: k.evalJs.apply(k, commands); break;\r\n      case 11: k.extractEventData.apply(k, commands); break;\r\n      case 12: k.listFiles.apply(k, commands); break;\r\n      case 13: k.uploadFile.apply(k, commands); break;\r\n      case 14: k.resetForm.apply(k, commands); break;\r\n      default: console.error(`Procedure ${pCode} is undefined`);\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    clearInterval(this._intervalId);\r\n    this._connection.dispatcher.removeEventListener(\"message\", this._messageHandler);\r\n    this._korolev.destroy();\r\n  }\r\n}\r\n\r\n/** @param {boolean} value */\r\nexport function setProtocolDebugEnabled(value) {\r\n  window.localStorage.setItem(ProtocolDebugEnabledKey, value.toString());\r\n  protocolDebugEnabled = value;\r\n}\r\n","const MIN_RECONNECT_TIMEOUT = 200;\r\nconst MAX_RECONNECT_TIMEOUT = 5000;\r\n\r\n/** @enum {number} */\r\nexport const ConnectionType = {\r\n  WEB_SOCKET: 0,\r\n  LONG_POLLING: 1\r\n};\r\n\r\n/**\r\n * Reconnectable WebSocket connection\r\n * with fallback to Long Polling.\r\n */\r\nexport class Connection {\r\n\r\n  /**\r\n   * @param {string} deviceId\r\n   * @param {string} sessionId\r\n   * @param {string} serverRootPath\r\n   * @param {Location} location\r\n   */\r\n  constructor(deviceId, sessionId, serverRootPath, location) {\r\n    this._deviceId = deviceId;\r\n    this._sessionId = sessionId;\r\n    this._serverRootPath = serverRootPath;\r\n\r\n    this._hostPort = location.host;\r\n    this._useSSL = location.protocol === \"https:\";\r\n\r\n    this._reconnectTimeout = MIN_RECONNECT_TIMEOUT;\r\n    this._webSocket = null;\r\n    this._webSocketsSupported = window.WebSocket !== undefined;\r\n    this._connectionType = ConnectionType.LONG_POLLING;\r\n    this._wasConnected = false;\r\n\r\n    /** @type {?ConnectionType} */\r\n    this._selectedConnectionType = null;\r\n\r\n    /** @type {?function(string)} */\r\n    this._send = null;\r\n    this._dispatcher = window.document.createDocumentFragment();\r\n  }\r\n\r\n  get dispatcher() { return this._dispatcher }\r\n\r\n  /**\r\n   * @param {string} type\r\n   * @private\r\n   * @return Event\r\n   */\r\n  _createEvent(type) {\r\n    if (typeof Event === \"function\") {\r\n      return new Event(type);\r\n    } else {\r\n      let event = document.createEvent('Event');\r\n      event.initEvent(type, false, false);\r\n      return event\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {ConnectionType} connectionType\r\n   * @private\r\n   */\r\n  _connectUsingConnectionType(connectionType) {\r\n    switch (connectionType) {\r\n      case ConnectionType.LONG_POLLING:\r\n        this._connectUsingLongPolling();\r\n        break;\r\n      case ConnectionType.WEB_SOCKET:\r\n        this._webSocketsSupported\r\n          ? this._connectUsingWebSocket()\r\n          : this._connectUsingLongPolling();\r\n        break;\r\n    }\r\n  }\r\n\r\n  /** @private */\r\n  _connectUsingWebSocket() {\r\n\r\n    let url = (this._useSSL ? \"wss://\" : \"ws://\") + this._hostPort;\r\n    let path = this._serverRootPath + `bridge/web-socket/${this._deviceId}/${this._sessionId}`;\r\n    let uri = url + path;\r\n\r\n    this._webSocket = new WebSocket(uri);\r\n    this._send = (data) => this._webSocket.send(data);\r\n    this._connectionType = ConnectionType.WEB_SOCKET;\r\n\r\n    this._webSocket.addEventListener('open', (event) => this._onOpen());\r\n    this._webSocket.addEventListener('close', (event) => this._onClose());\r\n    this._webSocket.addEventListener('error', (event) => this._onError());\r\n    this._webSocket.addEventListener('message', (event) => this._onMessage(event.data));\r\n    \r\n    console.log(`Trying to open connection to ${uri} using WebSocket`);\r\n  }\r\n\r\n  /** @private */\r\n  _connectUsingLongPolling() {\r\n\r\n    let url = (this._useSSL ? \"https://\" : \"http://\") + this._hostPort;\r\n    let path = this._serverRootPath + `bridge/long-polling/${this._deviceId}/${this._sessionId}/`;\r\n    let uriPrefix = url + path;\r\n\r\n    /** @type {function(boolean)} */\r\n    let subscribe = (firstTime) => {\r\n\r\n      let onReadyStateChange = (event) => {\r\n        let request = event.target;\r\n        if (request.readyState !== 4)\r\n          return;\r\n        switch (request.status) {\r\n          case 200:\r\n            if (firstTime)\r\n              this._onOpen();\r\n            this._onMessage(request.responseText);\r\n          case 503:\r\n            // Poll again\r\n            subscribe(false);\r\n            break;\r\n          default:\r\n            this._onError();\r\n            this._onClose();\r\n            break;\r\n        }\r\n      };\r\n\r\n      let request = new XMLHttpRequest();\r\n      request.addEventListener('readystatechange', onReadyStateChange);\r\n      request.open('GET', uriPrefix + 'subscribe', true);\r\n      request.send('');\r\n    };\r\n\r\n    /** @type {function(string)} */\r\n    let publish = (data) => {\r\n\r\n      let onReadyStateChange = (event) => {\r\n        let request = event.target;\r\n        if (request.readyState !== 4)\r\n          return;\r\n        switch (request.status) {\r\n          case 0:\r\n          case 400:\r\n            this._onError();\r\n            break;\r\n        }\r\n      };\r\n\r\n      let request = new XMLHttpRequest();\r\n\r\n      request.open('POST', uriPrefix + 'publish', true);\r\n      request.setRequestHeader(\"Content-Type\", \"application/json\");\r\n      request.addEventListener('readystatechange', onReadyStateChange);\r\n      request.send(data);\r\n    }\r\n\r\n    this._connectionType = ConnectionType.LONG_POLLING;\r\n    this._send = publish;\r\n\r\n    subscribe(true);\r\n    console.log(`Trying to open connection to ${uriPrefix} using long polling`);\r\n  }\r\n\r\n  /** @private */\r\n  _onOpen() {\r\n    console.log(\"Connection opened\");\r\n    let event = this._createEvent('open');\r\n    this._wasConnected = true;\r\n    this._reconnectTimeout = MIN_RECONNECT_TIMEOUT;\r\n    this._selectedConnectionType = this._connectionType;\r\n    this._dispatcher.dispatchEvent(event);\r\n  }\r\n\r\n  /** @private */\r\n  _onError() {\r\n    console.log('Connection error');\r\n    let event = this._createEvent('error');\r\n    this._dispatcher.dispatchEvent(event);\r\n  }\r\n\r\n  /** @private */\r\n  _onClose() {\r\n    console.log('Connection closed');\r\n    let event = this._createEvent('close');\r\n    this._dispatcher.dispatchEvent(event);\r\n  }\r\n\r\n\r\n  /**\r\n   * @param {string} data\r\n   * @private\r\n   */\r\n  _onMessage(data) {\r\n    let event = this._createEvent('message');\r\n    event.data = data;\r\n    this._dispatcher.dispatchEvent(event);\r\n  }\r\n\r\n  /**\r\n   * @param {string} data\r\n   */\r\n  send(data) {\r\n    this._send(data);\r\n  }\r\n\r\n  disconnect() {\r\n    if (this._webSocket != null) {\r\n        this._webSocket.close();\r\n        this._onClose();\r\n    } else {\r\n        console.log(\"Disconnect allowed only for WebSocket connections\")\r\n    }\r\n  }\r\n\r\n  connect() {\r\n\r\n    if (this._wasConnected)\r\n      console.log('Reconnecting...');\r\n\r\n    if (this._selectedConnectionType !== null) {\r\n      let ct = this._selectedConnectionType;\r\n      setTimeout(\r\n        () => this._connectUsingConnectionType(ct),\r\n        this._reconnectTimeout\r\n      );\r\n    } else {\r\n      switch (this._connectionType) {\r\n        case ConnectionType.WEB_SOCKET:\r\n          setTimeout(\r\n            () => this._connectUsingConnectionType(ConnectionType.LONG_POLLING),\r\n            this._reconnectTimeout\r\n          );\r\n          break;\r\n        case ConnectionType.LONG_POLLING:\r\n          setTimeout(\r\n            () => this._connectUsingConnectionType(ConnectionType.WEB_SOCKET),\r\n            this._reconnectTimeout\r\n          );\r\n          break;\r\n      }\r\n    }\r\n\r\n    this._reconnectTimeout = Math.min(this._reconnectTimeout * 2, MAX_RECONNECT_TIMEOUT);\r\n  }\r\n\r\n}\r\n\r\n","import { Connection } from './connection.js';\r\nimport { Bridge, setProtocolDebugEnabled } from './bridge.js';\r\nimport { ConnectionLostWidget, getDeviceId } from './utils.js';\r\n\r\nwindow['Korolev'] = {\r\n  'setProtocolDebugEnabled': setProtocolDebugEnabled,\r\n  'invokeCallback': () => console.log(\"Korolev is not ready\"),\r\n  'swapElementInRegistry': () => console.log(\"Korolev is not ready\")\r\n};\r\n\r\nwindow.document.addEventListener(\"DOMContentLoaded\", () => {\r\n\r\n  let reconnect = true\r\n  let config = window['kfg'];\r\n  let clw = new ConnectionLostWidget(config['clw']);\r\n  let connection = new Connection(\r\n    getDeviceId(),\r\n    config['sid'],\r\n    config['r'],\r\n    window.location\r\n  );\r\n\r\n  window['Korolev']['disconnect'] = () => {\r\n    reconnect = false;\r\n    connection.disconnect();\r\n  }\r\n\r\n  window['Korolev']['connect'] = () => connection.connect();\r\n\r\n  connection.dispatcher.addEventListener('open', () => {\r\n    clw.hide();\r\n    let bridge = new Bridge(config, connection);\r\n    window['Korolev']['swapElementInRegistry'] = (a, b) => bridge._korolev.swapElementInRegistry(a, b);\r\n    window['Korolev']['element'] = (qsid) => bridge._korolev.element(qsid);\r\n    window['Korolev']['invokeCallback'] = (name, arg) => bridge._korolev.invokeCustomCallback(name, arg);\r\n    let closeHandler = (event) => {\r\n      bridge.destroy();\r\n      clw.show();\r\n      connection\r\n        .dispatcher\r\n        .removeEventListener('close', closeHandler);\r\n    };\r\n    connection\r\n      .dispatcher\r\n      .addEventListener('close', closeHandler);\r\n  });\r\n\r\n  connection.dispatcher.addEventListener('close', () => {\r\n    if (reconnect) {\r\n      connection.connect();\r\n    }\r\n  });\r\n\r\n  connection.connect();\r\n});\r\n"],
"names":["$jscomp.global","getCookie","matches","document","cookie","match","RegExp","name","replace","decodeURIComponent","undefined","constructor","ConnectionLostWidget","template","_element","_template","show","element","createElement","innerHTML","children","body","appendChild","hide","removeChild","Korolev","config","callback","root","els","renderNum","rootListeners","historyHandler","initialPath","window","location","pathname","eventData","listenRoot","this.listenRoot","preventDefault","listener","event","target","vId","DOM_EVENT","type","addEventListener","push","this.historyHandler","state","HISTORY","windowHandler","this.windowHandler","destroy","?.prototype","forEach","o","removeEventListener","setRenderNum","n","registerRoot","aux","prefix","node","childNodes","i","length","child","qsid","self","rootNode","cleanRoot","listenEvent","create","childId","xmlNs","tag","parent","newElement","createElementNS","parentNode","replaceChild","remove","extractProperty","descriptor","propertyName","value","ERROR","result","OBJECT","JSON","stringify","STRING","NUMBER","BOOLEAN","EXTRACT_PROPERTY_RESPONSE","focus","setTimeout","changePageUrl","path","history","pushState","uploadForm","formData","FormData","form","request","XMLHttpRequest","deviceId","open","send","listFiles","input","files","uri","map","f","size","join","uploadFile","fileName","file","setRequestHeader","console","error","resetForm","reset","reloadCss","links","getElementsByTagName","link","getAttribute","href","getMilliseconds","Date","evalJs","code","status","eval","e","Promise","then","res","EVALJS_RESPONSE","err","resultString","toString","extractEventData","data","EXTRACT_EVENT_DATA_RESPONSE","Connection","sessionId","serverRootPath","_deviceId","_sessionId","_serverRootPath","_hostPort","host","_useSSL","protocol","_reconnectTimeout","MIN_RECONNECT_TIMEOUT","_webSocket","_webSocketsSupported","WebSocket","_connectionType","LONG_POLLING","_wasConnected","_send","_selectedConnectionType","_dispatcher","createDocumentFragment","_createEvent","Event","createEvent","initEvent","_connectUsingConnectionType","connectionType","_connectUsingLongPolling","WEB_SOCKET","_connectUsingWebSocket","this._send","_onOpen","_onClose","_onError","_onMessage","log","subscribe","firstTime","onReadyStateChange","readyState","responseText","uriPrefix","publish","dispatchEvent","disconnect","close","connect","ct","Math","min","MAX_RECONNECT_TIMEOUT","$jscomp.global.Object.defineProperties","dispatcher","protocolDebugEnabled","localStorage","getItem","ProtocolDebugEnabledKey","Bridge","connection","_korolev","_onCallback","bind","_connection","_messageHandler","interval","parseInt","_intervalId","setInterval","HEARTBEAT","args","message","commands","parse","pCode","shift","k","apply","atad","reverse","r","pop","createTextNode","text","isProperty","setAttribute","setAttributeNS","removeAttribute","removeAttributeNS","style","clearInterval","setProtocolDebugEnabled","setItem","invokeCallback","swapElementInRegistry","reconnect","clw","closeHandler","bridge","a","b","arg","CUSTOM_CALLBACK"]
}
